(window.webpackJsonp=window.webpackJsonp||[]).push([[8],{524:function(e,t,i){"use strict";i.r(t);var a=i(473),n=i(19),o=i(60);var r=function e(t,i){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e);var a=t&&t.asset&&t.asset.chartbeat_account_id;if(!a)throw new Error("accountId is required");if(!i)throw new Error("youtubeVideoPlayer is required");var n,o,r=window._sf_async_config=window._sf_async_config||{};r.uid=a,r.domain=new URL(t.host.host.url).host,(window._cbv||(window._cbv=[])).push(i),n=document.createElement("script"),o=document.getElementsByTagName("script")[0],n.type="text/javascript",n.async=!0,n.src="//static.chartbeat.com/js/chartbeat_video.js",o.parentNode.insertBefore(n,o)},s=i(543);function u(e,t){for(var i=0;i<t.length;i++){var a=t[i];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}function d(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function l(e,t,i){return(l="undefined"!==typeof Reflect&&Reflect.get?Reflect.get:function(e,t,i){var a=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=c(e)););return e}(e,t);if(a){var n=Object.getOwnPropertyDescriptor(a,t);return n.get?n.get.call(i):n.value}})(e,t,i||e)}function c(e){return(c=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function h(e,t){return(h=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var y=[],p={2:"The request contains an invalid parameter value.",5:"The requested content cannot be played in an HTML5 player.",100:"The requested video was not found.",101:"The video owner does not allow it to be played in embedded players.",150:"The video owner does not allow it to be played in embedded players."},v=function(e){function t(e,i){var a,n,r;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),n=this,(a=!(r=c(t).call(this,e,i))||"object"!==typeof r&&"function"!==typeof r?d(n):r).embedConfig="",a.videoIndex=0,a.resetState(),a.options=Object(o.b)({controls:1,modestbranding:1,rel:0,showInfo:0,timedEvents:{},start:i.params.start_time||0},i.params),a.options.autoplay=a.autoplayVideo,a.video.ytpp_enabled&&(a.embedConfig=JSON.stringify({autonavRelatedVideos:a.video.continuous_play_enabled,disableRelatedVideos:!a.video.continuous_play_enabled,relatedChannels:f(a.video.provider_class,a.video.youtube_channel),relatedVideos:a.video.continuous_play_enabled?a.video.youtube_playlist_ids:[]}),delete a.options.rel),a.asset.parsely_site_id&&(a.parsely=new s.a(d(a))),a}var i,a,v;return function(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&h(e,t)}(t,e),i=t,(a=[{key:"load",value:function(){this.mark("YouTubeLoadTime"),this.api()?this.build():(window.onYouTubeIframeAPIReady||(window.onYouTubeIframeAPIReady=function(){return y.forEach((function(e){return e.build()}))},Object(o.d)("//www.youtube.com/iframe_api")),y.push(this))}},{key:"api",value:function(){return window.YT}},{key:"build",value:function(){var e=this;if(!this.player){var t=this.api();this.player=new t.Player(this.el.id,{videoId:this.video.youtube_id||this.video.provider_video_id,playerVars:this.options,embedConfig:this.embedConfig,events:{onReady:function(t){e.asset.chartbeat_account_id&&(e.chartbeat=new r(e,t.target)),e.trackTimeSinceMark(n.a.LOAD_TIME,"YouTubeLoadTime"),e.resetState(),e.el.addEventListener("playTimeUpdate",(function(){e.trackQuartiles(),e.trackThresholds()})),e.autoplayVideo&&e.onStart()},onStateChange:function(i){switch(i.data){case t.PlayerState.UNSTARTED:return e.onStart();case t.PlayerState.PLAYING:return e.onPlaying();case t.PlayerState.ENDED:return e.onEnded();case t.PlayerState.PAUSED:return e.onPaused()}},onError:function(t){e.track({action:n.a.ERROR,value:t.data,index:e.videoIndex,message:p[t.data]||"Unknown error."})}},width:"100%",height:"100%"})}}},{key:"resetState",value:function(){this.player&&(this.youtubeId=this.player.getVideoData().video_id),this.currentQuartile=0,this.watchedSeconds=0,this.currentThreshold=0,this.eventQueue=[],this.staleVideo=!1}},{key:"onStart",value:function(){this.firstPlayTriggered||0!==this.videoIndex||(this.mark("YouTubeTTFF"),this.firstPlayTriggered=!0,this.track({action:n.a.PLAY}))}},{key:"onPlaying",value:function(){this.pauseOtherPlayers(),this.timeStart(),this.played&&this.youtubeId!==this.player.getVideoData().video_id&&this.relatedVideoStart(),this.played||0!==this.videoIndex||(this.trackTimeSinceMark(n.a.TTFF,"YouTubeTTFF"),this.played=!0,this.track({action:n.a.START,value:this.duration(),index:this.videoIndex}))}},{key:"onEnded",value:function(){this.timeStop(),this.watchedSeconds=0,this.track({action:n.a.COMPLETE,value:Math.floor(.25*this.player.getDuration()),index:this.videoIndex})}},{key:"onPaused",value:function(){this.timeStop()}},{key:"track",value:function(e){this.staleVideo?this.eventQueue.shift(e):l(c(t.prototype),"track",this).call(this,e)}},{key:"relatedVideoStart",value:function(){this.videoIndex=this.videoIndex+1,this.resetState(),this.setVideoByYoutubeId(this.youtubeId)}},{key:"setVideoByYoutubeId",value:function(e){var t=this;this.staleVideo=!0;var i=new XMLHttpRequest;i.open("GET","/api/videos/by_platform_id/youtube/"+e,!0),i.onload=function(){200===i.status?t.video=JSON.parse(i.responseText):t.video=t.getNonVolumeRelatedVideo()},i.onerror=function(){t.video=t.getNonVolumeRelatedVideo()},i.onloadend=function(){t.staleVideo=!1,Object(o.e)("SENDING "+t.eventQueue.length+" queued events."),t.eventQueue.forEach((function(e){return t.track(e)})),t.eventQueue.length=0,t.track({action:n.a.START,value:t.duration(),index:t.videoIndex})},i.send()}},{key:"getNonVolumeRelatedVideo",value:function(){return{id:0,title_short:this.player.getVideoData().title,description_short:this.player.getVideoData().description,youtube_id:this.player.getVideoData().video_id}}},{key:"duration",value:function(){return this.player?this.player.getDuration():0}},{key:"percentComplete",value:function(){return this.player?this.player.getCurrentTime()/this.duration()*100:0}},{key:"quartileValue",value:function(){var e=this.duration()/4;return e>1?Math.floor(e):Object(o.c)(e)}},{key:"trackQuartiles",value:function(){var e=this.percentComplete();e>=75&&2===this.currentQuartile?(this.currentQuartile=3,this.track({action:n.a.THIRD_QUARTILE,value:this.quartileValue(),index:this.videoIndex})):e>=50&&1===this.currentQuartile?(this.currentQuartile=2,this.track({action:n.a.SECOND_QUARTILE,value:this.quartileValue(),index:this.videoIndex})):e>=25&&0===this.currentQuartile&&(this.currentQuartile=1,this.track({action:n.a.FIRST_QUARTILE,value:this.quartileValue(),index:this.videoIndex}))}},{key:"trackThresholds",value:function(){this.currentThreshold<3&&this.watchedSeconds>=3&&(this.currentThreshold=3,this.track({action:n.a.THREE_SECONDS,value:3,index:this.videoIndex})),this.currentThreshold<10&&this.watchedSeconds>=10&&(this.currentThreshold=10,this.track({action:n.a.TEN_SECONDS,value:10,index:this.videoIndex})),this.currentThreshold<30&&this.watchedSeconds>=30&&(this.currentThreshold=30,this.track({action:n.a.THIRTY_SECONDS,value:30,index:this.videoIndex}))}},{key:"play",value:function(){this.player&&this.player.playVideo()}},{key:"pause",value:function(){this.player&&this.player.stopVideo()}},{key:"destroy",value:function(){this.player&&this.player.destroy()}},{key:"unmute",value:function(){this.player&&this.player.unMute()}}])&&u(i.prototype,a),v&&u(i,v),t}(a.a);function f(e,t){var i={verge:["txJFU9DgUhfr2J2bveCHkQ"],"vrg-sci":["ddiUEpeqJcYeBxX1IVBKvQ"],polygon:["Dqau170byfm1ksTQ0jYNpg"],"polygon-guides":["uVxaQDraOja6xKidcmoufA"]};"UC"===t.substring(0,2)&&(t=t.substring(2));var a=[t];return e in i&&(a=a.concat(i[e])),a}t.default=v}}]);
//# sourceMappingURL=embed-youtube-686844740178de63b3aa.chunk.js.map